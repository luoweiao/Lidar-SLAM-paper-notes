# 激光SLAM

## 1、激光雷达及其关键模块算法

### 1.前端扫描匹配

- 内容：基于已知前一帧位姿根据相邻帧关系估计当前帧位姿

- 方法：

	- 1、ICP及其变种

		- 利用两帧点云最小欧式距离，求解R和t

			- 1、已知对应点：直接求解

			- 2、未知对应点：迭代求解

		- 方法：

			- point-to-line

			- PL-ICP

			- ICP

			- point-to-plane

			- PP-ICP

	- 2、相关性匹配扫描
CSM（似然场模型）

	- 3、基于优化的方法

		- 给定目标函数，将激光匹配问题当做非线性最小二乘优化问题

		- 方法： Hector-SLAM

	- 4、NDT正态分布变化

		- 将地图看做很多高斯分布集合，直接最小化目标函数获取R和t

	- 5、基于特征的匹配

		- Monar：匹配激光点云中提取到的特征点

		- Zhang：匹配激光与地图中边线和平面特征

	- 6、其他匹配方法

		- Deschaud:基于特定采样策略的scan-to-model

		- Nicolai：基于深度学习，将3D点云数据投影到2D平面生成深度图像，再利用CNN网联训练得到端到端匹配结果

		- 在无法获取较好初值时

			- Bosse：基于投影直方图和熵序列为迭代扫描匹配直接计算初值，将旋转和平移估计分解为一系列相关性直方图

			- Checchin：利用毫米波雷达深度数据，经过变换，对相邻帧间刚体变换进行自动计算和全局估计

			- Martinez：一种解空间的遗传搜索方法获取初值，将ICP误差度量作为适应度函数，评估并改变初始估计直至留下单个主导变换

			- Corso：一种抗离群点分段遗传扫描匹配（FGSM）

				- 1、使用分段均方根距离度量排除离群点干扰

				- 2、通过变换函数，遗传扫描匹配用于搜索目标函数局部最小值

				- 3、用解空间离散化方法改善计算成本

- 当前流行匹配算法

	- 2D-激光SLAM：CSM结合梯度优化

		- Cartographer

	- 3D-激光SLAM：基于特征匹配

		- LOAM

### 2. 后端优化

- 内容：长时间增量扫描匹配后优化里程计与地图信息

- 方法（解决遗留局部误差累计）

	- 1、基于滤波器

		- 简介：基于滤波器的激光SLAM为贝叶斯估计过程，包括

			- 里程计预测

			- 测量预测

			- 进行测量

			- 数据关联

			- 状态更新

			- 地图更新

		- 滤波形式

			- 卡尔曼滤波（KF）

			- 扩展卡尔曼滤波（EKF）

			- 迭代卡尔曼滤波（IEKF）

			- 无迹卡尔曼滤波（UKF）

			- 粒子滤波（PF）

				- 常用于激光SLAM作为数学优化的框架

				- Tipaldi：不需要每个粒子的栅格地图

				- 需要更新栅格地图时，Strom：建议计算子图，必要时更新，使得最终图时所有子图的栅格化

	- 2、基于图优化

		- 简介：利用图论的方式表示SLAM过程，将位姿用节点（node）表示，节点间空间约束关系用边（edge）表示，通过非线性最小二乘优化建图过程中积累的误差

			- 即同时考虑所有帧间约束，迭代线性化求解

		- 方法

			- 基于图优化方法

			- 局部scan-to-scan方法

			- 基于子图特征的直方图的匹配

### 3.闭环检测

- 内容：检测闭环减少全局地图漂移

	- 简介：利用闭环约束条件达成拓扑一致的轨迹地图

	- 方法：

		- 1、scan-to-scan

			- Olson：采用相关性扫描通过R和t判断点云相关性（不适用于2D）

		- 2、scan-to-map

			- Cartographer

			- Corso:使用分段遗传扫描匹配算法（FGSM）

		- 3、map-to-map

			- Bosse：对于全局匹配，利用现有的直方图互相关技术，引入熵序列投影直方图和穷举相关方法在非结构化环境中实现可靠匹配

			- 文国成：子地图与子地图匹配，定位筛选和压缩表，优化闭环检测匹配候选集

			- Konolige：当前帧子图与已有地图比较，基于相关性实现闭环检测

		- 4、其他闭环检测算法

			- Olson：像素精确的扫描匹配方法

			- Himstedt：基于直方图匹配

			- Granstrom：检测扫描数据中的特征点，结合深度学习匹配

		- 5、闭环检测到加速策略

			- Cartographer:分支定界（branch and bound）

- 局限性：误报导致错误闭环

	- Bosse：基于投影直方图和熵序列之间最大相关性之和的验证度量用于估计闭环检测正确性

	- Granstrom：基于变换后扫描的最后配准的验证标准（非结构化室外环境下测试）

	- Corso：（室内，将闭环验证与检测分离）提出两个既能表征场景复杂性，又能表征几何对齐的验证度量

- 最常用方法：scan-to-map匹配，利用分支定界加速匹配，结合延时决策保证闭环正确

### 4.地图构建

- 内容：生成维护全局地图

	- 尺度地图

		- 栅格地图

		- 特征地图

		- 点云地图

	- 拓扑地图

	- 语义地图

## 2、激光SLAM方案对比

### 基于滤波器

- 1988年-扩展卡尔曼滤波SLAM（EKF－SLAM）

	- 使用最大似然估计进行数据关联

	- 不足：

		- 1、计算量复杂，鲁棒性差

		- 2、构建为特征地图，无法用于导航避障

- 2002年-Monemerlo：FastSLAM，将SLAM分解为定位+已知位姿的构图（实现栅格地图输出）

	- 方法：

		- 1、用粒子滤波估计位姿，将每个粒子用运动学模型进行传播

		- 2、对于传播后粒子，使用观测模型进行权重计算并根据估计的位姿构建地图

	- 不足：

		- 1、在大尺度环境中（每个粒子包含轨迹及对应环境地图）若里程计误差大，则需消耗更多粒子表示位姿后验概率分布

		- 2、由于重采样随机性，随着重采样次数增多，粒子多样性散失，粒子耗散问题严重影响地图构建

- 2007年-Grisetti:Gmapping方案（2D）

	- 方法：

		- 在内存消耗上，通过将粒子数保持在较小的值，对预测分布采样，基于优化扫描匹配优化位姿

		- 粒子耗散和重采样问题上，使用一个度量表示预测分布与真实分布差异性，根据度量值大小确定是否进行重采样

	- 不足：

		- 里程计在模型传播时，对所有粒子同等对待，粒子退化问题严重（依赖里程计精度）

- 2010年-Blanco：optimalRBPF

	- 方法：

		- 里程计模型传播时，一个粒子传播得到N个粒子，选择其中最优粒子作为真实传播

### 基于图优化

- 2D激光SLAM

	- Lu：首次提出图优化数学框架优化SLAM，通过非线性最小二乘法优化建图过程中累计误差

	- Gut-mann：提出图优化框架

		- 局部扫描匹配

		- 全局优化

		- 子图与子图的闭环检测

	- 2010年-Konolige：Karto SLAM

		- 考虑了系统稀疏性

		- 不足：

			- 局部子图匹配前都需构建子图，耗时长

			- 采用全局匹配时，搜索范围大速度会变慢

	- 2016年-Cartographer

		- 方法

			- 核心

				- 融合多传感器的局部子图创建

				- 用于闭环检测到扫描匹配策略

			- 前段扫描匹配算法结合CSM和梯度优化实现

			- 生成子地图后进行局部闭环检测

			- 全部子地图构建完成，利用分支定界与预先计算的网格的算法，进行全局闭环检测

		- 不足

			- 未对闭环检测结果进行验证，在几何对称环境中易导致错误闭环

	- 2011年-Kohlbrecher：Hector-SLAM

		- 方法

			- 采用高斯牛顿法解决前端匹配，将每一帧点云数据与地图匹配

		- 不足

			- 对初值敏感

			- 难易处理闭环问题

			- 在强旋转时，易发生漂移

			- 仅有前段扫描匹配模块，无后端优化过程

			- 与Gmapping相比，不需要里程计数据，里程计信息由激光雷达结算出，对于传感器测量频率要求高

- 3D激光SLAM

	- 2014年-Zhang：LOAM方案

		- 方法：

			- 利用激光采集数据

			- 进行基于特征点的扫描匹配，利用非线性优化方法进行运动估计

			- 激光里程计输出与地图匹配

				- 直线匹配

				- 平面匹配

		- 不足：

			- 无回环检测

			- 点面特征还不够可靠

			- 匀速运动假设

	- 2015年-Zhang：结合视觉里程计的3D激光实时建图V-LOAM

		- 方法：

			- 视觉里程计高频率估计位姿变换

			- 激光里程计低频率优化运动估计

		- 优势：

			- 传感器高速运动、受光照变化时，鲁棒性好

		- 不足：

			- 漂移匀速假设

			- 无闭环检测

	- 2016年-Lu：增强视觉结合激光SLAM的VELO新方案

		- 方法：

			- 紧耦合的稀疏视觉与激光数据－前端扫描匹配

			- 利用位姿图的稀疏性进一步优化位姿误差

		- 优势：

			- 低漂移性

			- 当单个传感器受遮挡时能可靠运行

		- 不足：

			- 无运动畸变假设

	- 2018年-Nicolai：基于特定的采样策略和scan-to-model的匹配方式

		- 纯激光SLAM

		- 优势

			- 不依赖GPS、IMU等传感器

			- 低漂移

	- 2018年-Zhang：自我运动估计和建图数据处理的LVIO

		- 方法：

			- 使用

				- 3D激光SLAM

				- 相机

				- IMU

			- 顺序多层运行三个模块以产生实时自我运动估计

			- 由粗到精数据处理产生高速率估计

			- 在长距离中构建低漂移地图

		- 优势：

			- 低漂移

			- 光照、旋转、结构退化环境下鲁棒性好

## 3、发展趋势

### 1、深度学习结合激光SLAM

- Nicolai：前端扫描匹配结合深度学习，实现高维传感器数据处理与融合

- 邹勤：闭环检测模块与深度学习结合，构建一种深度bash网络对激光点云样本进行hash编码并计算样本相似度，实现相似样本快速检索

- 融合多传感器，配合物体检测、识别解析算法

	- 语义SLAM

	- 实时三维重建

### 2、多传感器融合SLAM

- Bok：松耦合+图优化融合2D激光雷达、GPS、相机，用于文物保护的室外SLAM系统

- Shen/Lynen：紧耦合的EKF估计器，融合多传感器信息的MAV系统

### 3、提升SLAM实时性与鲁棒性

- 提升鲁棒性

	- 方向：

		- 里程计标定

		- 激光雷达外参与时间戳标定

		- 激光雷达运动畸变去除

		- 退化环境

		- 全局定位

		- 动态定位

	- Corso（背包SLAM）：激光雷达与惯性传感器在线外参与时间戳标定

	- 石鹏：动态环境下的激光SLAM

	- Zhang：自我运动估计并构建地图的数据处理方法

- 提升实时性

	- Zhang：两种不同频率模块并行计算

	- Park：稠密的以地图为中心的CT－SLAM，用于多传感器模块融合

	- Droeschel：基于高效的局部地图和分层的优化后端，提出分层连续时间的3D激光SLAM犯法，允许建图期间优化配准

